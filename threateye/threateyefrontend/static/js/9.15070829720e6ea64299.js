webpackJsonp([9],{"4bp+":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAfZJREFUSA3NVj0sBEEU/t5agggSoVBfJEIvKj/RKdAqKCkUTi7RKK5QXrhEIWodItESiQqFWklFhObE3yXcjW/3bi4zyyXsWkwyeW9+3ve9eftm3gK/3AQLaggKy+RtjZk7B8GSYF5dkagzZjINf+1+IBOccu5R74goG2jfxwh6PF7r1EppCGxgVWaRUoMooh0rsq0XQsukWqPtnLa3CR3c+AsFpOnVAHXRGyPIC9PWJiyixV90kOUJt8yNEXTHtPWSRhkTz9T32V+MufCqoJaRGiFA5QbYJwQauTgeniFgaR6lvBQkPGA+zcBBPUNaizfcBSC+N3SIprDOPqoNbUIHx8jIJZLqiJsGkJXoSbOgzqoTFlHneyI4orzVXkWSCjWmvZ004pNs0qO8uSm0Lv4BponXoTFsQj0bo7TuSIw8FWiXEe6pjH5CKeDEh6lB/2dwLqMcLfWDqHl+Ma9VwXX5pvxMNgaJq+D+wTc0PRM8cbjL7r2lCQZnuLz8SrnD2vFQHn9NlOrgGDe3aQP7pQH2WA+n/MW0qkeu/IgLDjk/qY2+JZPqjo4vahs7pOaFT4t5+cNXD7EfkeAJu5BWTfQmz+D2wgtkqSU430zVK19fb/d+eeo2Df7gpRGcmx7EqpPLZeZNkCTFXqnKMZF6/6WZmLD/Eew7V+BzCUVeTKEAAAAASUVORK5CYII="},"5/0U":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAdZJREFUOBGtlLlKA1EUhjM3o7ZWQmxFTCE2yQtkqdwtfQ61UXHFIOhD5AkkiqBglgdwLGwiYq9tkjaZjN8JucNkchNH8cDl7P+c5c61YgZyHGei2WxudrvdTcuy0oTMcjzOJ+fZ87ySbdu3mUymgz5A1oCGUqlUtki44syFfSH9Ix6P72az2bug3QcEQAF2Cd8LBvwk00Ehl8sdwqWDmNIJfwGTXArYL5fL5xqnV6G0ybxutDHM+foxiZPYD8I+rROzls/n7y1ZQKPReCNh5MyYVZIPThHzqgHCHMB34hZVq9WSJYwECyeO0sFYaLfby8p13Y1RQb+1K6XWFaXKPfsXosqUbFkubRQausSGpIQA9u6PwembGEuSDdbpxr8evjMg4PcEUH6nsURgsVqtpgA9GgdKy18C6IxFw0ngNNemXKvV0n3QoimHpTgCWDI5wzYBpfUnfoJt5JmwX3TsdxZftTudTh193hQU1cYo6vzTS0qeIHk1oiaa4mQZ2HfgrrQckycIpWAKjmIj95TZPkpsD1AEeYJgFyJHJamMRZxQ0JnO8d9DbeApWkW+ZsAL2mbigMncd3RlOmYIUBz9Ra2QtAZwClNCqoG+4C/ot3T0gOxKfJC+AYFJx11kAs3kAAAAAElFTkSuQmCC"},HF0D:function(e,t){},lMEi:function(e,t){},mURi:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAUdJREFUOBGtlL1OAkEUhXdw6a1IsLWAygYegiiuUPoykig0PAINjQ8gNhQ8gtFOYwi1lr6AOnxnI8kOLDObxZOc3Nm595752XvHRDmw1laZ7v2xjT2BFn7AJ/gAZ8aYb6wfiPXhCoawJCDZq4azAschlRz/iDmzI1xSbKM/dASZ1TF9uME59AXg66aiDKowdGcNYs6gD+844wqqfXjqbLncR4O0cwlelcvPzUokqDr7L7QkqKItgnARR1FdguqAEJp0xRtBd4FAG/Fn9HdC+CKgJTHsrSf4RQH3noCsS6LpfWOnWUdmPNGR1ehFcEzQguRrbG1PwqN2GEM1+qF4ReAoXYhBcqDaL/kdZ9dM6NUoi4Ejpg+UDAw9ANsLamcDuPt8bVbA2YVFSkl35h4TkVxlAmN8F/ASqv7qUA3wCZ/hDM4p9h+sgzXB+yp5jl3YMgAAAABJRU5ErkJggg=="},"oMQ+":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("fZjL"),i=a.n(s),o=a("lHA8"),r=a.n(o),n=a("Gu7T"),l=a.n(n),_={name:"detail-network",data:function(){return{loading:!1,network_work_order:{work_name:"",workorder_id:"",work_order_status:""},attack_stage_list:[{name:"Initial Access",value:"初始访问",count:0},{name:"Execution",value:"执行",count:0},{name:"Persistence",value:"持久化",count:0},{name:"Privilege Escalation",value:"提权",count:0},{name:"Defense Evasion",value:"防御逃逸",count:0},{name:"Credential Access",value:"凭证访问",count:0},{name:"Discovery",value:"信息发现",count:0},{name:"Lateral Movement",value:"横向移动",count:0},{name:"Collection",value:"信息收集",count:0},{name:"Command and Control",value:"命令控制",count:0},{name:"Exfiltration",value:"信息泄露",count:0},{name:"Impact",value:"毁坏",count:0}],suggest_list:[{name:"",des:"",handle:[],reinforce:[]},{name:"恶意文件通讯\t",des:"攻击者在机器上装了恶意程序，该恶意程序通过常见的协议或者定制的协议和外部服务器通讯。",handle:["1、把机器从网络隔离；","2、根据告警详情里的“网络事件”里的机器端口定位机器的恶意进程；","3、做安全分析确认根因以及威胁扩散程度。如果安装有EDR解决方案，可以直接通过历史信息做安全事件调查快速定位问题；","4、安装防病毒软件做全盘扫描。"],reinforce:["1、提升端点安全能力；","2、用网络安全设备禁止不需要联网的设备联网；","3、用网络威胁检测工具及早发现外联威胁。"]},{name:"广告软件\tAdware",des:"广告软件是危险性相对较低的恶意软件，但可能会导致更大的威胁发生，所以也需要及时清除。",handle:["1、把机器从网络隔离；","2、根据告警详情里的“网络事件”里的机器端口定位机器的恶意进程；","3、做安全分析确认根因以及威胁扩散程度。如果安装有EDR解决方案，可以直接通过历史信息做安全事件调查快速定位问题；","4、安装防病毒软件做全盘扫描。"],reinforce:["1、提升端点安全能力；","2、用网络安全设备禁止不需要联网的设备联网；","3、用网络威胁检测工具及早发现外联威胁。"]},{name:"危险工具\tgraytool",des:"危险工具有可能被管理员或者是内部的安全工具所使用，但大部分情况是网络失陷的标志。这些工具有可能用于扫描、信息收集或者是控制，需要看具体工具确定攻击目的。",handle:["1、确认是否是管理员或者是安全工具的合法使用；","2、如果不是，需要根据威胁指标的提示做相应的处置。"],reinforce:["根据实际使用的危险工具做具体的加固。"]},{name:"漏洞利用\tExploit",des:"攻击者利用机器上所装应用或者服务的漏洞进行漏洞利用攻击。在网络流量中检测到这种漏洞利用行为并不一定代表被攻击机器中漏洞利用的成功。",handle:["1、在被攻击机器上确认漏洞利用是否成功；","2、如果漏洞利用成功， 隔离该机器并做安全分析"],reinforce:["1、对Web应用程序采用WAF减小攻击面；","2、关闭机器上不必要的服务，采用Windows EMET等技术防止漏洞利用；","3、对机器上的应用和服务采用应用隔离、沙箱、以及最小权限等措施减少被攻击后的访问权限；","4、做好网络划分，增加横向移动难度；","5、利用威胁情报以及定期做漏洞扫描发现漏洞，及时打重要漏洞补丁。"]},{name:"其他\tOthers",des:"无",handle:["无"],reinforce:["无"]},{name:"EICAR\teicar",des:"EICAR是一个用于测试的不具有危害的但防病毒软件会告警的程序。",handle:["不需要处置。"],reinforce:["无"]},{name:"SQL注入\tsqlinjection",des:"SQL注入是攻击者利用数据库设计、开发、缺乏校验等漏洞而导致应用做非设计本意的行为。",handle:["1、根据SQL注入脚本确认注入是否成功；","2、由于SQL注入漏洞的不同，注入可以导致不同的结果。根据具体注入脚本的行为做处置。"],reinforce:["1、采用WAF等安全设备减小攻击面；","2、对机器上的应用和服务采用应用隔离、沙箱、以及最小权限等措施减少被攻击后的访问权限；","3、定期做漏洞扫描发现漏洞，及时打重要漏洞补丁。"]},{name:"暴力破解\tBruteForce",des:"攻击者采用大量的猜测的账号和密码组合或者是少量的符合网络密码策略的常用密码(password spraying)尝试登录网络，一旦登录成功，就是合法账号登录，极难再被检测到。常见的被暴力破解攻击的服务包括：SSH (22/TCP)、Telnet (23/TCP)、FTP (21/TCP)、NetBIOS / SMB / Samba (139/TCP & 445/TCP)、LDAP (389/TCP)、Kerberos (88/TCP)、RDP / Terminal Services (3389/TCP)、HTTP/HTTP Management Services (80/TCP & 443/TCP)、MSSQL (1433/TCP)、Oracle (1521/TCP)、MySQL (3306/TCP)、VNC (5900/TCP)。",handle:["1、查看被攻击机器的系统登录日志确认是否暴力破解登录成功。如果成功，修改该账号密码；","2、如果是外部威胁，在安全网关上阻止该攻击地址。"],reinforce:["1、采用合适的账号锁定策略，在一定数量的失败登录后锁定账号。但这个策略不能制定太严格，避免在攻击的时候造成被攻击的大量账号全部被锁定。对于关键应用，在一定数量的失败登录后要求格外的验证可以有效解决这个问题；","2、采用多因素认证；","3、参考NIST密码策略制定网络密码策略。"]},{name:"WebShell\tWebShell",des:"Web Shell是利用失窃账号或者漏洞而放置在Web服务器上用来和攻击者交互的入口。",handle:["1、确认是否成功，如果成功，隔离机器并做清除、扫描和安全分析；","2、重点关注是否有横向移动的痕迹。"],reinforce:["1、根据根因分析结果打补丁或者修改账号密码；","2、管理Web服务器的账号需要和内网的账号做区分。"]},{name:"扫描\tScan",des:"攻击者通过扫描发现运行在机器上的服务，包括可能存在漏洞的服务。 ",handle:["无"],reinforce:["1、及时打重大漏洞补丁；","2、禁用不需要的服务；","3、对关键服务，创建访问列表防止未知机器的访问甚至限制远程访问。"]},{name:"恶意程序\tmalwarefile",des:"下载了一个恶意程序到机器里，可能是恶意文件下载、恶意文件拷贝或者是恶意的邮件附件等。",handle:["1、根据告警详情里的“网络事件”里的机器端口定位是什么进程下载了恶意程序；","2. 如果机器里安装有防病毒软件，根据本系统检测的文件名或者哈希值确认恶意程序是否已经被查杀；","3、如果没有被查杀，而且恶意程序没有被执行，手动清除恶意程序；","4. 如果恶意程序得到了执行，清除执行后的进程、子进程以及可能生成的或者下载的更多的恶意程序。"],reinforce:["1、安装防病毒软件并且及时更新病毒库；","2、用户安全意识培训避免下载恶意程序或者点击恶意邮件附件。"]},{name:"恶意地址\tmalware",des:"机器访问了带有恶意程序的地址。",handle:["1、根据告警详情里的“网络事件”里的机器端口定位是什么进程访问了这个恶意地址；","2、安装防病毒软件并且更新到最新做全盘查杀。"],reinforce:["1、安装防病毒软件并且及时更新病毒库；","2、用户安全意识培训提升安全意识。"]},{name:"tor出口节点\ttor_exit_node",des:"攻击者用Tor隐藏攻击来源和加密通讯通道，但也存在部分用户用Tor保护隐私的情况。",handle:["1、确认机器的使用者是否合法使用Tor；","2、如果确认被攻击，根据告警详情里的“网络事件”里的机器端口定位是什么进程访问了这个节点，从而做相应的处置。"],reinforce:["1、安装防病毒软件并且及时更新病毒库；","2、考虑用网络安全设备阻止Tor节点地址。"]},{name:"tor入口节点\ttor_node",des:"攻击者用Tor隐藏攻击来源和加密通讯通道，但也存在部分用户用Tor保护隐私的情况。",handle:["1、确认机器的使用者是否合法使用Tor；","2、如果确认被攻击，根据告警详情里的“网络事件”里的机器端口定位是什么进程访问了这个节点，从而做相应的处置。"],reinforce:["1、安装防病毒软件并且及时更新病毒库；","2、考虑用网络安全设备阻止Tor节点地址。"]},{name:"垃圾邮件\tspam ",des:"垃圾邮件本身不具有安全威胁，是不想在网络里出现的信息。",handle:["无"],reinforce:["通过网络安全设备阻止垃圾邮件地址。"]},{name:"僵尸网络C&C\tbotc&c ",des:"攻击者在机器上装了恶意程序，该恶意程序通过常见的协议或者定制的协议和外部服务器通讯。",handle:["1、把机器从网络隔离；","2、根据告警详情里的“网络事件”里的机器端口定位机器的恶意进程；","3、做安全分析确认根因以及威胁扩散程度。如果安装有EDR解决方案，可以直接通过历史信息做安全事件调查快速定位问题；","4、安装防病毒软件做全盘扫描。"],reinforce:["1、提升端点安全能力；","2、用网络安全设备禁止不需要联网的设备联网；","3、用网络威胁检测工具及早发现外联威胁。"]},{name:"移动恶意软件\tmobilemalware",des:"下载了一个恶意程序到机器里，可能是恶意文件下载、恶意文件拷贝或者是恶意的邮件附件等。",handle:["1、根据告警详情里的“网络事件”里的机器端口定位是什么进程下载了恶意程序；","2. 如果机器里安装有防病毒软件，根据本系统检测的文件名或者哈希值确认恶意程序是否已经被查杀；","3、如果没有被查杀，而且恶意程序没有被执行，手动清除恶意程序；","4. 如果恶意程序得到了执行，清除执行后的进程、子进程以及可能生成的或者下载的更多的恶意程序。"],reinforce:["1、安装防病毒软件并且及时更新病毒库；","2、用户安全意识培训避免下载恶意程序或者点击恶意邮件附件。"]},{name:"网络诈骗\tfraud",des:"通过社交工程等手段引诱用户上当。",handle:["1、如果存在金钱损失等情况应及时做相应的应急处理；","2、对机器做扫描和安全分析。"],reinforce:["1、考虑用网络安全设备拦截网络诈骗地址；","2、用户通过安全意识培训识别社交工程等手段。"]},{name:"恶意重定向\tmaliciousredirect",des:"通过重定向把用户引入恶意地址。",handle:["1、如果存在恶意感染、信息泄露等情况应及时做相应的应急处理；","2、对机器做扫描和安全分析。"],reinforce:["1、考虑用网络安全设备拦截恶意重定向地址；","2、用户通过安全意识培训提升安全意识。"]},{name:"网络代理\tproxy",des:"攻击者用网络代理隐藏攻击来源和加密通讯通道，但也存在部分用户用网络代理保护隐私的情况。",handle:["1、确认机器的使用者是否合法使用网络代理；","2、如果确认被攻击，根据告警详情里的“网络事件”里的机器端口定位是什么进程访问了这个节点，从而做相应的处置。"],reinforce:["1、安装防病毒软件并且及时更新病毒库；","2、考虑用网络安全设备阻止网络代理地址。"]},{name:"钓鱼网站\tphishing",des:"通过社交工程等手段引诱用户点击某个链接、下载文档甚至可执行文件或者输入账号等信息达到窃取信息、利用浏览器漏洞或者植入恶意程序的目的。",handle:["1、如果存在账号等信息失窃行为应及时更改账号密码和相应的应急处理；","2、对机器做扫描和安全分析。"],reinforce:["1、考虑用网络安全设备拦截钓鱼地址；","2、用户通过安全意识培训识别社交工程等手段。"]},{name:"勒索软件通讯\transomwareurl",des:"该地址用于下载勒索软件或者是跟勒索软件通讯。",handle:["1、把机器从网络隔离；","2、如果是下载了勒索软件，及时清除该软件；","3、如果被勒索软件加密，先搜索安全公司的网站看是否有解密工具。"],reinforce:["1、用网络安全设备阻止该地址；","2、安装防病毒软件并且及时更新病毒库。"]},{name:"已知APT攻击",des:"本威胁是检测到网络与曾经被APT组织使用过的地址通讯或者是相关工具出现在网络中。",handle:["1、确认被检测的威胁指标是否还有效；","2、如果确认有效，需要根据APT组织的相关情报信息做应急响应并做最高优先级处理。"],reinforce:["根据该APT组织的战术、技术和流程（TTP）做相应的安全加固。"]},{name:"恶意证书",des:"机器里的程序采用恶意的ssl证书跟外界通讯。",handle:["1、把机器从网络隔离；","2、根据告警详情里的“网络事件”里的机器端口定位机器的恶意进程；","3、做安全分析确认根因以及威胁扩散程度。如果安装有EDR解决方案，可以直接通过历史信息做安全事件调查快速定位问题；","4、安装防病毒软件做全盘扫描。"],reinforce:["1、提升端点安全能力；","2、用网络安全设备禁止不需要联网的设备联网；","3、用网络威胁检测工具及早发现外联威胁。"]}],network_detail:{attack_stage_cn:"",label_obj:[],src_label_obj:[],dest_label_obj:[]},title_name:"告警详情",network_times:[],network_list:{new_list:{handle:{page:1,rows:10}},old_list:{handle:{page:1,rows:10}}},time_choose:0,emerge_list:{title:["当前告警资产","历史告警资产"],activeName:"first",choose:0,now_data:{page:1,rows:10},old_data:{page:1,rows:10},now:{},old:{}},src_active_ul:!1,edit_tag:{tag_list:[],pop:!1},worksheets_data:{page:1,rows:10,pop:!1,tableRadio:{},level_list:[{value:"highest",label:"极高"},{value:"high",label:"高"},{value:"medium",label:"中"},{value:"low",label:"低"}],status_type:["无","待分配","已分配","处置中","已取消","已处置"]},worksheets_list:{},new_worksheets_list:{name:"",level:"",operator:"",new_operator:[],notice:["email"],textarea:"",multiple:[],select_list:[]},new_worksheets_data:{pop:!1,new_contet:!0,operator_list:[],level_list:[{value:"highest",label:"最高"},{value:"high",label:"高"},{value:"medium",label:"中"},{value:"low",label:"低"}],table_operator:{tableData:[],tableData_new:[],count:0,pageNow:1,maxPage:1,eachPage:5},network_detail:[]},table_alerts:{tableData:[],count:0,pageNow:1,maxPage:1,eachPage:10,loading:!0,multipleSelection:[]},add_state_change:!1,table_add_works:{tableData:[],count:0,pageNow:1,maxPage:1,eachPage:10,loading:!0,multipleSelection:[]},add_params:{name:"",level:"",operator:[],notice:["email"],remarks:"",multiple:[],old_as:[]}}},components:{backTitle:a("UeIv").a},mounted:function(){this.get_data(),console.log(this.$route.query)},methods:{open_add_new:function(){this.add_open_state()},add_open_state:function(){var e=this.table_alerts.tableData[0].status;"3"==e||"4"==e||"5"==e?this.$message({message:"告警状态为已处置、已忽略、误报的不能添加到工单。",type:"warning"}):(this.add_state_change=!0,this.get_table_works_list())},add_closed_state1:function(){this.add_state_change=!1,this.add_params={name:"",level:"",operator:"",new_operator:[],notice:["email"],textarea:"",multiple:[],old_as:[]}},get_table_works_list:function(){var e=this,t="",a="";switch(this.$route.query.type){case"alert":t="/yiiapi/alert/workorder-list",a="alert";break;case"asset":t="/yiiapi/asset/workorder-list",a="asset";break;case"lateral":t="/yiiapi/horizontalthreat/workorder-list",a="alert";break;case"outside":t="/yiiapi/externalthreat/workorder-list",a="alert";break;case"outreath":t="/yiiapi/outreachthreat/workorder-list",a="alert"}this.$axios.get(t,{params:{page:this.table_add_works.pageNow,rows:this.table_add_works.eachPage,type:a}}).then(function(t){console.log("*************8"),console.log(t),e.table_add_works.loading=!1;var a=t.data,s=a.status,i=a.data;if(0==s){var o=i.data,r=i.count,n=i.maxPage,l=i.pageNow;o.map(function(e,t){e.new_perator=JSON.parse(e.perator).join(","),e.checked=!1}),e.table_add_works.tableData=o,e.table_add_works.count=r,e.table_add_works.maxPage=n,e.table_add_works.pageNow=Number(l)}})},handle_sel_table_add_works:function(e){console.log("&&&&&3434"),console.log(e),this.table_add_works.multipleSelection=e},add_ok_state:function(){var e=this,t=this.table_alerts.tableData.map(function(e){return 1*e.id});this.add_params.multiple=t;var a=this.table_add_works.multipleSelection;if(0==a.length)this.$message({message:"请选择需要添加的工单！",type:"warning"});else if(a.length>1)this.$message({message:"资产/告警不能添加到多个工单，请重新选择！",type:"warning"});else{console.log("******************"),this.add_params.id=a[0].id,this.add_params.name=a[0].name,this.add_params.level=a[0].priority,this.add_params.perator=JSON.parse(a[0].perator),this.add_params.remarks=a[0].remarks,this.add_params.remind=JSON.parse(a[0].remind),this.add_params.old_as=JSON.parse(a[0].te_alert),this.add_params.multiple=[].concat(l()(this.add_params.multiple),l()(this.add_params.old_as)),console.log(this.add_params.multiple),this.add_params.multiple=[].concat(l()(new r.a(this.add_params.multiple)));var s=this.add_params.multiple.filter(function(e){return e});this.add_params.multiple=s,console.log(this.add_params),console.log(this.add_params.perator),this.loading=!0;var i="";switch(this.$route.query.type){case"alert":i="/yiiapi/alert/add-workorder";break;case"asset":i="/yiiapi/asset/add-workorder";break;case"lateral":i="/yiiapi/horizontalthreat/add-workorder";break;case"outside":i="/yiiapi/externalthreat/add-workorder";break;case"outreath":i="/yiiapi/outreachthreat/add-workorder"}this.$axios.post(i,{id:this.add_params.id,type:"alert",name:this.add_params.name,priority:this.add_params.level,perator:this.add_params.perator,remind:this.add_params.remind,remarks:this.add_params.remarks,te_alert:this.add_params.multiple}).then(function(t){e.loading=!1;var a=t.data,s=a.status,i=a.msg;a.data;0==s?(e.$message.success("添加成功"),e.add_closed_state1(),e.get_data()):1==s&&e.$message.error(i)}).catch(function(e){console.log(e)})}},sc_table_add_works:function(e){this.table_add_works.eachPage=e,this.table_add_works.pageNow=1,this.get_table_works_list()},hcc_table_add_works:function(e){this.table_add_works.pageNow=e,this.get_table_works_list()},get_rex:function(e){return/[\u4e00-\u9fa5]| /.test(e)},get_data:function(){var e=this;this.loading=!0,console.log(this.$route.query.detail);var t="";switch(this.$route.query.type){case"alert":t="/yiiapi/alert/alert-details";break;case"asset":t="/yiiapi/asset/alert-details";break;case"lateral":t="/yiiapi/horizontalthreat/alert-details";break;case"outside":t="/yiiapi/externalthreat/alert-details";break;case"outreath":t="/yiiapi/outreachthreat/alert-details"}this.$axios.get(t,{params:{id:this.$route.query.detail}}).then(function(t){e.loading=!1,console.log("*************************************"),console.log(t);var a=[];a.push(t.data.data),e.table_alerts.tableData=a,console.log("*************************************"),e.network_detail=t.data.data,e.network_detail.attack_stage_cn="",e.network_detail.src_label_obj=JSON.parse(e.network_detail.src_label),e.network_detail.dest_label_obj=JSON.parse(e.network_detail.dest_label),e.network_detail.label?e.network_detail.label_obj=JSON.parse(e.network_detail.label):e.network_detail.label_obj=[];var s="";switch(e.$route.query.type){case"alert":s="/yiiapi/alert/workorders";break;case"asset":s="/yiiapi/asset/workorders";break;case"lateral":s="/yiiapi/horizontalthreat/workorders";break;case"outside":s="/yiiapi/externalthreat/workorders";break;case"outreath":s="/yiiapi/outreachthreat/workorders"}e.$axios.get(s,{params:{id:e.$route.query.detail}}).then(function(t){console.log(t.data),e.$nextTick(function(){if(console.log(t.data),e.network_work_order.workorder_id=t.data.data.workorder_id,"0"==t.data.data.workorder_id)console.log(213213),e.network_work_order.work_order_status="未关联工单",e.network_work_order.work_name="";else if(t.data.data.workorder_status&&t.data.data.workorder_name){switch(t.data.data.workorder_status+=""){case"0":e.network_work_order.work_order_status="待分配";break;case"1":e.network_work_order.work_order_status="已分配";break;case"2":e.network_work_order.work_order_status="处置中";break;case"3":e.network_work_order.work_order_status="已处置";break;case"4":e.network_work_order.work_order_status="已取消"}e.network_work_order.work_name=t.data.data.workorder_name}else e.network_work_order.work_order_status="",e.network_work_order.work_name=""})}).catch(function(e){console.log(e)}),e.network_times=[],e.network_times.push(e.network_detail),0!=e.network_detail.alarm_merger.length&&e.network_detail.alarm_merger.forEach(function(t){t.attack_stage_cn="",e.network_times.push(t)}),console.log(e.network_times),e.network_times.forEach(function(e){if(e.info_list=[],e.whois_list=[],e.event_list=[],e.alert_description.whois)for(var t in e.alert_description.whois){var a={name:t,value:e.alert_description.whois[t]};e.whois_list.push(a)}else if(e.alert_description.ip_whois)for(var s in e.alert_description.ip_whois){a={name:s,value:e.alert_description.ip_whois[s]};e.whois_list.push(a)}switch(e.description_type){case"BotnetCAndCURL":e.info_list=[{name:"URL",value:e.alert_description.mask},{name:"威胁类型",value:e.alert_description.category},{name:"威胁细分",value:e.alert_description.threat},{name:"全球首次发现时间",value:e.alert_description.first_seen},{name:"流行度",value:e.alert_description.popularity},{name:"主要受影响地区",value:e.alert_description.geo}];case"RansomwareURL":e.info_list=[{name:"URL",value:e.alert_description.mask},{name:"威胁类型",value:e.alert_description.category},{name:"全球首次发现时间",value:e.alert_description.first_seen},{name:"流行度",value:e.alert_description.popularity},{name:"IP",value:e.alert_description.IP}];break;case"IPReputation":e.info_list=[{name:"IP",value:e.alert_description.ip},{name:"威胁类型",value:e.alert_description.category},{name:"全球首次发现时间",value:e.alert_description.first_seen},{name:"流行度",value:e.alert_description.popularity},{name:"主要受影响地区",value:e.alert_description.geo},{name:"相关联域名",value:e.alert_description.domains}];break;case"MaliciousHash":e.info_list=[{name:"MD5",value:e.alert_description.MD5},{name:"SHA256",value:e.alert_description.SHA256},{name:"文件大小",value:e.alert_description.file_size},{name:"文件类型",value:e.alert_description.file_type},{name:"常见文件名",value:e.alert_description.file_name},{name:"威胁类型",value:e.alert_description.category},{name:"威胁细分",value:e.alert_description.threat},{name:"全球首次发现时间",value:e.alert_description.first_seen},{name:"流行度",value:e.alert_description.popularity},{name:"主要受影响地区",value:e.alert_description.geo},{name:"样本下载IP地址",value:e.alert_description.IP}];break;case"MaliciousURL":e.info_list=[{name:"URL",value:e.alert_description.mask},{name:"威胁类型",value:e.alert_description.category},{name:"全球首次发现时间",value:e.alert_description.first_seen},{name:"流行度",value:e.alert_description.popularity},{name:"主要受影响地区",value:e.alert_description.geo},{name:"相关联恶意文件",value:e.alert_description.file}];break;case"PhishingURL":e.info_list=[{name:"URL",value:e.alert_description.mask},{name:"威胁类型",value:e.alert_description.category},{name:"全球首次发现时间",value:e.alert_description.first_seen},{name:"流行度",value:e.alert_description.popularity},{name:"主要受影响地区",value:e.alert_description.geo},{name:"被钓鱼IP",value:e.alert_description.IP}];break;case"MobileMaliciousHash":e.info_list=[{name:"MD5",value:e.alert_description.MD5},{name:"SHA256",value:e.alert_description.SHA256},{name:"文件大小",value:e.alert_description.file_size},{name:"威胁类型",value:e.alert_description.category},{name:"威胁细分",value:e.alert_description.threat},{name:"全球首次发现时间",value:e.alert_description.first_seen},{name:"流行度",value:e.alert_description.popularity},{name:"主要受影响地区",value:e.alert_description.geo}];break;case"sdk":e.info_list=[{name:"威胁类型",value:e.alert_description.category},{name:"文件名",value:e.alert_description.file_name},{name:"文件大小",value:e.alert_description.file_size},{name:"文件哈希值",value:e.alert_description.md5},{name:"SDK检测威胁",value:e.alert_description.threat}];break;case"sandbox":e.info_list=[{name:"威胁类型",value:e.alert_description.category},{name:"文件名",value:e.alert_description.filename},{name:"文件大小",value:e.alert_description.size},{name:"文件类型",value:e.alert_description.type},{name:"MD5",value:e.alert_description.md5},{name:"SHA1",value:e.alert_description.sha1},{name:"SHA256",value:e.alert_description.sha256},{name:"taskID",value:e.alert_description.taskID}];break;case"yara":e.info_list=[{name:"文件名",value:e.alert_description.file_name},{name:"文件大小",value:e.alert_description.file_size},{name:"文件哈希值",value:e.alert_description.md5},{name:"Yara规则名称",value:e.alert_description.rule_name}];break;case"IDS":e.info_list=[{name:"告警类型",value:e.alert_description.category},{name:"告警描述",value:e.alert_description.threat},{name:"PayLoad信息",value:"点击下载"}]}switch(e.network_event.event_type){case"fileinfo":switch(e.network_event.app_proto){case"smtp":e.network_event.email.to.length>1&&(e.network_event.email_to=e.network_event.email.to.join(",")),e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Mail_from",value:e.network_event.email.from},{name:"Recpt_to",value:e.network_event.email_to},{name:"Traffic",value:"smtp"}];break;case"http":e.event_list=[{name:"Method",value:e.network_event.http.http_method},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"URL",value:e.network_event.http.url},{name:"User Agent",value:e.network_event.http.http_user_agent},{name:"Referrer",value:e.network_event.http.http_refer},{name:"Traffic",value:"http"}];break;case"ftp-data":e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"User",value:"-"},{name:"Traffic",value:"FTP"}];break;case"imap":e.network_event.email.to.length>1&&(e.network_event.email_to=e.network_event.email.to.join(",")),e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Mail_from",value:e.network_event.email.from},{name:"Recpt_to",value:e.network_event.email_to},{name:"Traffic",value:"imap"}];break;case"pop3":e.network_event.email.to.length>1&&(e.network_event.email_to=e.network_event.email.to.join(",")),e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Mail_from",value:e.network_event.email.from},{name:"Recpt_to",value:e.network_event.email_to},{name:"Traffic",value:"pop3"}];break;case"smb":e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Domain",value:"-"},{name:"User",value:"-"},{name:"Traffic",value:"smb"}];break;default:e.network_event.app_proto?"failed"==e.network_event.app_proto&&(e.network_event.app_proto=""):e.network_event.app_proto=e.network_event.proto,e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Traffic",value:e.network_event.app_proto}]}break;case"flow":switch(e.network_event.app_proto){case"ftp":e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"User",value:e.network_event.user},{name:"Traffic",value:e.network_event.app_proto}];break;default:e.network_event.app_proto?"failed"==e.network_event.app_proto&&(e.network_event.app_proto=""):e.network_event.app_proto=e.network_event.proto,e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Traffic",value:e.network_event.app_proto}]}break;case"smb":e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Domain",value:"-"},{name:"User",value:"-"},{name:"Traffic",value:e.network_event.event_type}];break;case"ssh":e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Tool",value:e.network_event.ssh.client.software_version},{name:"User",value:"-"},{name:"Traffic",value:e.network_event.event_type}];break;case"tls":e.network_event.tls.subject&&(e.network_event.tls.Authorizing=e.network_event.tls.subject.substring(e.network_event.tls.subject.indexOf("CN=")+3)),e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"URL",value:e.network_event.tls.sni},{name:"Issuerdn",value:e.network_event.tls.issuerdn},{name:"Authorizing",value:e.network_event.tls.Authorizing},{name:"Notafter",value:e.network_event.tls.notafter},{name:"Traffic",value:"https"}];break;case"dns":e.network_event.dns.grouped&&(e.network_event.dns.HostAddr=e.network_event.dns.grouped.join(",")),e.network_event.dns.answers&&e.network_event.dns.answers.forEach(function(t){e.network_event.dns.rrname==t.rrname&&(e.network_event.dns.ttl=t.ttl,e.network_event.dns.rrtype=t.rrtype)}),e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"SectianType",value:e.network_event.dns.rrtype},{name:"Domain",value:e.network_event.dns.rrname},{name:"TTL",value:e.network_event.dns.HostAddr},{name:"Traffic",value:"dns"}];break;case"krb5":e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Msg_type",value:e.network_event.krb5.msg_type},{name:"Cname",value:e.network_event.krb5.cname},{name:"Realm",value:e.network_event.krb5.realm},{name:"Sname",value:e.network_event.krb5.sname},{name:"Traffic",value:"krb5"}];break;case"http":e.event_list=[{name:"Method",value:e.network_event.http.http_method},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"URL",value:e.network_event.http.url},{name:"User Agent",value:e.network_event.http.http_user_agent},{name:"Referrer",value:e.network_event.http.http_refer},{name:"Traffic",value:"http"}];break;case"alert":switch(e.network_event.app_proto){case"tls":e.network_event.tls.subject&&(e.network_event.tls.Authorizing=e.network_event.tls.subject.substring(e.network_event.tls.subject.indexOf("CN=")+3)),e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"URL",value:e.network_event.tls.sni},{name:"Issuerdn",value:e.network_event.tls.issuerdn},{name:"Authorizing",value:e.network_event.tls.Authorizing},{name:"Notafter",value:e.network_event.tls.notafter},{name:"Traffic",value:"https"}];break;case"http":e.event_list=[{name:"Method",value:e.network_event.http.http_method},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"URL",value:e.network_event.http.url},{name:"User Agent",value:e.network_event.http.http_user_agent},{name:"Referrer",value:e.network_event.http.http_refer},{name:"Traffic",value:"http"}];break;default:e.network_event.app_proto?"failed"==e.network_event.app_proto&&(e.network_event.app_proto=""):e.network_event.app_proto=e.network_event.proto,e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Traffic",value:e.network_event.app_proto}]}default:e.network_event.app_proto?"failed"==e.network_event.app_proto&&(e.network_event.app_proto=""):e.network_event.app_proto=e.network_event.proto,e.event_list=[{name:"Time",value:e.network_event.timestamp},{name:"Source IP",value:e.network_event.src_ip+":"+e.network_event.src_port},{name:"Destination IP",value:e.network_event.dest_ip+":"+e.network_event.dest_port},{name:"Traffic",value:e.network_event.app_proto}]}}),e.attack_stage_list.forEach(function(t){t.count=0,e.network_detail.attack_stage==t.name&&(e.network_detail.attack_stage_cn=t.value)}),e.network_times.forEach(function(t){e.attack_stage_list.forEach(function(e){t.attack_stage==e.name&&(t.attack_stage_cn=e.value,e.count=e.count+1)})}),e.new_list(),e.old_list()}).catch(function(e){console.log(e)})},Goto_workorder:function(){switch(this.$route.query.type){case"alert":this.$router.push({path:"/detail/works",query:{id:this.network_work_order.workorder_id,type:"alert_detail"}});break;case"asset":this.$router.push({path:"/detail/works",query:{id:this.network_work_order.workorder_id,type:"asset"}});break;case"lateral":this.$router.push({path:"/detail/works",query:{id:this.network_work_order.workorder_id,type:"lateral"}});break;case"outside":this.$router.push({path:"/detail/works",query:{id:this.network_work_order.workorder_id,type:"outside"}});break;case"outreath":this.$router.push({path:"/detail/works",query:{id:this.network_work_order.workorder_id,type:"outreath"}})}},download:function(e,t){if("点击下载"==e.value&&"PayLoad信息"==e.name){!function(e,t){var a=document.createElement("a");a.download=t,a.style.display="none";var s=new Blob([e]);a.href=URL.createObjectURL(s),document.body.appendChild(a),a.click(),document.body.removeChild(a)}(t.network_event.payload,"payload.dat")}if("点击下载"==e.value&&"文件下载"==e.name){var a="";switch(this.$route.query.type){case"alert":a="/yiiapi/alert/get-file?md5=";break;case"asset":a="/yiiapi/asset/get-file?md5=";break;case"lateral":a="/yiiapi/horizontalthreat/get-file?md5=";break;case"outside":a="/yiiapi/externalthreat/get-file?md5=";break;case"outreath":a="/yiiapi/outreachthreat/get-file?md5="}window.open(a+e.md5)}},new_list:function(){var e=this,t="";switch(this.$route.query.type){case"alert":t="/yiiapi/alert/get-same-indicator-alert";break;case"asset":t="/yiiapi/asset/get-same-indicator-alert";break;case"lateral":t="/yiiapi/horizontalthreat/get-same-indicator-alert";break;case"outside":t="/yiiapi/externalthreat/get-same-indicator-alert";break;case"outreath":t="/yiiapi/outreachthreat/get-same-indicator-alert"}this.$axios.get(t,{params:{indicator:this.network_detail.indicator,is_deal:0,page:this.emerge_list.now_data.page,rows:this.emerge_list.now_data.rows}}).then(function(t){var a=t.data,s=(a.status,a.data);e.emerge_list.now=s}).catch(function(e){console.log(e)})},handleSizeChange_now:function(e){this.emerge_list.now_data.rows=e,this.emerge_list.now_data.page=1,this.new_list()},handleCurrentChange_now:function(e){this.emerge_list.now_data.page=e,this.new_list()},old_list:function(){var e=this,t="";switch(this.$route.query.type){case"alert":t="/yiiapi/alert/get-same-indicator-alert";break;case"asset":t="/yiiapi/asset/get-same-indicator-alert";break;case"lateral":t="/yiiapi/horizontalthreat/get-same-indicator-alert";break;case"outside":t="/yiiapi/externalthreat/get-same-indicator-alert";break;case"outreath":t="/yiiapi/outreachthreat/get-same-indicator-alert"}this.$axios.get(t,{params:{indicator:this.network_detail.indicator,is_deal:2,page:this.emerge_list.old_data.page,rows:this.emerge_list.old_data.rows}}).then(function(t){var a=t.data,s=(a.status,a.data);e.emerge_list.old=s}).catch(function(e){console.log(e)})},handleSizeChange_old:function(e){this.emerge_list.old_data.rows=e,this.emerge_list.old_data.page=1,this.old_list()},handleCurrentChange_old:function(e){this.emerge_list.old_data.page=e,this.old_list()},change_state:function(e){var t=this;console.log(e);var a=[];a.push(this.$route.query.detail);var s="";switch(this.$route.query.type){case"alert":s="/yiiapi/alert/do-alarm";break;case"asset":s="/yiiapi/asset/do-alarm";break;case"lateral":s="/yiiapi/horizontalthreat/do-alarm";break;case"outside":s="/yiiapi/externalthreat/do-alarm";break;case"outreath":s="/yiiapi/outreachthreat/do-alarm"}this.$axios.put(s,{id:a,status:e}).then(function(e){var a=e.data,s=a.status,i=a.data;console.log(i),console.log(e),0==s?(t.get_data(),t.$message({message:"修改状态成功!",type:"success"})):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){console.log(e)})},edit_tag_box:function(){var e=this;this.edit_tag.tag_list=[],console.log(this.network_detail.label_obj),0==this.network_detail.label_obj.length?this.edit_tag.tag_list.push({name:"",icon:!0}):(this.network_detail.label_obj.forEach(function(t){var a={name:t,icon:!1};e.edit_tag.tag_list.push(a)}),this.edit_tag.tag_list[this.edit_tag.tag_list.length-1].icon=!0),this.edit_tag.pop=!0},edit_tag_true:function(){var e=this;console.log(this.edit_tag.tag_list);var t=[];this.edit_tag.tag_list.forEach(function(e){""!=e.name&&t.push(e.name)});var a="";switch(this.$route.query.type){case"alert":a="/yiiapi/alert/label-edit";break;case"asset":a="/yiiapi/asset/label-edit";break;case"lateral":a="/yiiapi/horizontalthreat/label-edit";break;case"outside":a="/yiiapi/externalthreat/label-edit";break;case"outreath":a="/yiiapi/outreachthreat/label-edit"}this.$axios.put(a,{id:this.$route.query.detail,label:t}).then(function(t){var a=t.data,s=a.status,i=a.data;console.log(i),0==s?(e.$message({message:"修改标签成功!",type:"success"}),e.edit_tag.pop=!1,e.get_data()):e.$message({message:i.msg,type:"error"})}).catch(function(e){console.log(e)})},closed_edit_tag_box:function(){this.edit_tag.pop=!1},add_tag:function(){this.edit_tag.tag_list.length<5?(this.edit_tag.tag_list.forEach(function(e){e.icon=!1}),this.edit_tag.tag_list.push({name:"",icon:!0})):this.$message.warning({message:"最多可以设置5个标签。",offset:50})},del_tag:function(e,t){this.edit_tag.tag_list.splice(t,1)},change_state_src:function(e){var t=this;console.log(e),"1"==e&&this.$router.push({path:"/invest/url",query:{src_ip:this.network_detail.src_ip,dest_ip:""}}),"2"==e&&this.$confirm("本地址会被加入外部动态列表，第三方设备读取后可以对本地址进行告警提示或者拦截。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e="";switch(t.$route.query.type){case"alert":e="/yiiapi/alert/join-external-dynamics";break;case"asset":e="/yiiapi/asset/join-external-dynamics";break;case"lateral":e="/yiiapi/horizontalthreat/join-external-dynamics";break;case"outside":e="/yiiapi/externalthreat/join-external-dynamics";break;case"outreath":e="/yiiapi/outreachthreat/join-external-dynamics"}t.$axios.post(e,{addr:t.network_detail.src_ip,type:1}).then(function(e){var a=e.data,s=a.status,i=a.data;console.log(i),0==s?t.$message({message:"加入外部动态列表成功!",type:"success"}):t.$message({message:i.msg,type:"error"})}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},change_state_dest:function(e){var t=this;console.log(e),"1"==e&&this.$router.push({path:"/invest/url",query:{dest_ip:this.network_detail.dest_ip,src_ip:""}}),"2"==e&&this.$confirm("本地址会被加入外部动态列表，第三方设备读取后可以对本地址进行告警提示或者拦截。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e="";switch(t.$route.query.type){case"alert":e="/yiiapi/alert/join-external-dynamics";break;case"asset":e="/yiiapi/asset/join-external-dynamics";break;case"lateral":e="/yiiapi/horizontalthreat/join-external-dynamics";break;case"outside":e="/yiiapi/externalthreat/join-external-dynamics";break;case"outreath":e="/yiiapi/outreachthreat/join-external-dynamics"}t.$axios.post(e,{addr:t.network_detail.dest_ip,type:1}).then(function(e){var a=e.data,s=a.status,i=a.data;console.log(i),0==s?t.$message({message:"加入外部动态列表成功!",type:"success"}):t.$message({message:i.msg,type:"error"})}).catch(function(e){console.log(e)})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},time_active:function(e){console.log("111"),this.time_choose=e},emerge_list_active:function(e){this.emerge_list.choose=e},src_active:function(){console.log("111"),this.src_active_ul=!this.src_active_ul},src_active_item:function(e){this.src_active_ul=!1,console.log(e)},handleSelectionChange:function(){},handleClick:function(e,t){console.log(e)},change_task:function(e){if("1"==e){if(this.new_worksheets_list.name="",this.new_worksheets_list.level="",this.new_worksheets_list.operator="",this.new_worksheets_list.new_operator="",this.new_worksheets_list.notice=["email"],this.new_worksheets_list.textarea="",this.new_worksheets_list.multiple=[],this.new_worksheets_list.select_list=[],this.new_worksheets_data.operator_list=[],this.new_worksheets_data.operator_list=[],this.new_worksheets_data.table_operator.tableData=[],this.new_worksheets_data.table_operator.tableData=[],this.new_worksheets_data.table_operator.count=0,this.new_worksheets_data.table_operator.pageNow=1,this.new_worksheets_data.table_operator.maxPage=1,this.new_worksheets_data.table_operator.eachPage=5,this.new_worksheets_data.network_detail=[],console.log(this.network_detail.status),"3"==this.network_detail.status||"4"==this.network_detail.status||"5"==this.network_detail.status)return this.$message({message:"告警状态为已处置、已忽略、误报的不能新建工单。",type:"warning"}),!1;this.get_user_list()}else"2"==e&&this.open_add_new()},get_worksheets_list:function(){var e=this,t="",a="";switch(this.$route.query.type){case"alert":t="/yiiapi/alert/workorder-list",a="alert";break;case"asset":t="/yiiapi/asset/workorder-list",a="asset";break;case"lateral":t="/yiiapi/horizontalthreat/workorder-list",a="alert";break;case"outside":t="/yiiapi/externalthreat/workorder-list",a="alert";break;case"outreath":t="/yiiapi/outreachthreat/workorder-list",a="alert"}this.$axios.get(t,{params:{page:this.worksheets_data.page,rows:this.worksheets_data.rows,type:a}}).then(function(t){var a=t.data,s=a.status,i=a.data;console.log(i),console.log(s),0==s&&(console.log(i),e.worksheets_list=i,e.worksheets_list.pageNow=1*i.pageNow,e.worksheets_data.pop=!0,e.worksheets_list.data.forEach(function(t){t.perator_cn=JSON.parse(t.perator).join(","),e.worksheets_data.level_list.forEach(function(e){t.priority==e.value&&(t.priority_cn=e.label)}),e.worksheets_data.status_type.forEach(function(a,s){t.status==s&&(t.status_cn=e.worksheets_data.status_type[s])})}))})},handleSizeChange_add:function(e){this.worksheets_data.rows=e,this.worksheets_data.page=1,this.worksheets_data.tableRadio={},this.get_worksheets_list()},handleCurrentChange_add:function(e){this.worksheets_data.page=e,this.worksheets_data.tableRadio={},this.get_worksheets_list()},add_closed_state:function(){this.worksheets_data.pop=!1},add_ok_worksheets:function(){var e=this;if(console.log(this.worksheets_data.tableRadio),0==i()(this.worksheets_data.tableRadio).length)return this.$message({message:"请选择工单！",type:"warning"}),!1;var t=[];JSON.parse(this.worksheets_data.tableRadio.te_alert).forEach(function(e){""!=e&&t.push(1*e)}),t.push(1*this.$route.query.detail),console.log(t);var a="";switch(this.$route.query.type){case"alert":a="/yiiapi/alert/add-workorder";break;case"asset":a="/yiiapi/asset/add-workorder";break;case"lateral":a="/yiiapi/horizontalthreat/add-workorder";break;case"outside":a="/yiiapi/externalthreat/add-workorder";break;case"outreath":a="/yiiapi/outreachthreat/add-workorder"}this.$axios.post(a,{id:this.worksheets_data.tableRadio.id,type:"alert",name:this.worksheets_data.tableRadio.name,perator:JSON.parse(this.worksheets_data.tableRadio.perator),priority:this.worksheets_data.tableRadio.priority,remind:JSON.parse(this.worksheets_data.tableRadio.remind),remarks:this.worksheets_data.tableRadio.remarks,te_alert:t}).then(function(t){var a=t.data,s=a.status,i=a.msg,o=a.data;console.log(o),0==s?(e.$message.success("添加成功"),e.get_data()):1==s&&e.$message.error(i),e.add_closed_state()}).catch(function(e){console.log(e)})},closed_task_new:function(){this.new_worksheets_data.pop=!1},get_user_list:function(){var e=this;this.$axios.get("/yiiapi/site/user-list").then(function(t){var a=t.data,s=a.status,i=a.data;e.new_worksheets_data.operator_list=0==s?i:[],e.new_worksheets_data.pop=!0,e.new_worksheets_data.new_contet=!0}).catch(function(e){console.log("用户列表错误"),console.log(e)})},select_changced:function(e){console.log(e),this.new_worksheets_data.table_operator.tableData.map(function(e){return e.id}).includes(e.id)?this.$message.error("已存在"):this.new_worksheets_data.table_operator.tableData.unshift(e);var t=this.new_worksheets_data.table_operator.pageNow,a=this.new_worksheets_data.table_operator.tableData.slice(5*(t-1),5*t);this.new_worksheets_data.table_operator.tableData_new=a;var s=this.new_worksheets_data.table_operator.tableData.map(function(e){return e.username});console.log(s),console.log(this.new_worksheets_data.table_operator.tableData)},hcc_table_operator:function(e){this.new_worksheets_data.table_operator.pageNow=e},next_task:function(){return""==this.new_worksheets_list.name?(this.$message.error("工单名称不能为空"),!1):""==this.new_worksheets_list.level?(this.$message.error("优先级未选择"),!1):""==this.new_worksheets_list.level?(this.$message.error("优先级未选择"),!1):""==this.new_worksheets_list.operator?(this.$message.error("经办人未选择"),!1):(this.new_worksheets_data.new_contet=!1,this.new_worksheets_data.network_detail.push(this.network_detail),void console.log(this.network_detail))},prev_task_handle:function(){this.new_worksheets_data.network_detail=[],this.new_worksheets_data.new_contet=!0},select_alert_new:function(e){this.new_worksheets_list.select_list=e,console.log(e)},prev_task_handle_assign:function(){var e=this,t=[],a=[];t.push(1*this.network_detail.id),this.new_worksheets_data.table_operator.tableData.forEach(function(e){a.push(e.username)}),console.log(t),console.log(a),console.log(this.new_worksheets_list);var s="";switch(this.$route.query.type){case"alert":s="/yiiapi/alert/distribution-workorder";break;case"asset":s="/yiiapi/asset/distribution-workorder";break;case"lateral":s="/yiiapi/horizontalthreat/distribution-workorder";break;case"outside":s="/yiiapi/externalthreat/distribution-workorder";break;case"outreath":s="/yiiapi/outreachthreat/distribution-workorder"}this.$axios.put(s,{name:this.new_worksheets_list.name,priority:this.new_worksheets_list.level,perator:a,remarks:this.new_worksheets_list.textarea,te_alert:t,remind:this.new_worksheets_list.notice}).then(function(t){var a=t.data,s=a.status,i=a.msg,o=a.data;console.log(o),0==s?(e.get_data(),e.new_worksheets_data.pop=!1,e.$message.success("分配成功")):1==s&&e.$message.error(i)}).catch(function(e){console.log(e)})},prev_task_handle_save:function(){var e=this,t=[],a=[];this.new_worksheets_data.table_operator.tableData.forEach(function(e){a.push(e.username)}),t.push(1*this.network_detail.id),console.log(t),console.log(this.new_worksheets_list);var s="";switch(this.$route.query.type){case"alert":s="/yiiapi/alert/add-workorder";break;case"asset":s="/yiiapi/asset/add-workorder";break;case"lateral":s="/yiiapi/horizontalthreat/add-workorder";break;case"outside":s="/yiiapi/externalthreat/add-workorder";break;case"outreath":s="/yiiapi/outreachthreat/add-workorder"}this.$axios.post(s,{type:"alert",name:this.new_worksheets_list.name,perator:a,priority:this.new_worksheets_list.level,remind:this.new_worksheets_list.notice,remarks:this.new_worksheets_list.textarea,te_alert:t}).then(function(t){var a=t.data,s=a.status,i=a.msg,o=a.data;console.log(o),0==s?(e.new_worksheets_data.pop=!1,e.$message.success("添加成功"),e.get_data()):1==s&&e.$message.error(i),e.add_closed_state()}).catch(function(e){console.log(e)})}},filters:{filterType:function(e){if(""!=e&&void 0!=e){if(0==e)return"0B";var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toPrecision(3)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]}}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"detail-network"},[s("back-title",{attrs:{"title-name":e.title_name}}),e._v(" "),s("div",{staticClass:"detail_base"},[s("div",{staticClass:"detail_base_top"},[e._m(0),e._v(" "),s("div",{staticClass:"top_right"},[s("el-row",{staticClass:"common_btn common_btn_124"},[s("el-col",{staticClass:"common_btn_list",attrs:{span:24}},[s("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start",size:"148"},on:{command:e.change_state}},[s("el-button",{staticClass:"change_btn",attrs:{type:"primary"}},[s("span",[e._v("状态变更")]),e._v(" "),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{staticClass:"dropdown_ul_box_124",attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{staticClass:"select_item",attrs:{command:"2"}},[e._v("处置中")]),e._v(" "),s("el-dropdown-item",{staticClass:"select_item",attrs:{command:"3"}},[e._v("已处置")]),e._v(" "),s("el-dropdown-item",{staticClass:"select_item",attrs:{command:"4"}},[e._v("已忽略")]),e._v(" "),s("el-dropdown-item",{staticClass:"select_item",attrs:{command:"5"}},[e._v("误报")])],1)],1),e._v(" "),s("el-dropdown",{attrs:{placement:"bottom-start",trigger:"click"},on:{command:e.change_task}},[s("el-button",{staticClass:"change_btn",attrs:{type:"primary"}},[s("span",[e._v("工单任务")]),e._v(" "),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{staticClass:"dropdown_ul_box_124",attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"1"}},[e._v("新建工单")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"2"}},[e._v("添加到工单")])],1)],1),e._v(" "),s("el-button",{staticClass:"edit_btn",on:{click:e.edit_tag_box}},[e._v("编辑标签")])],1)],1)],1)]),e._v(" "),s("div",{staticClass:"detail_base_bottom"},[s("div",{staticClass:"detail_base_bottom_item"},[s("ul",[s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("源地址:")]),e._v(" "),s("el-dropdown",{staticClass:"src_dropdown_box",attrs:{trigger:"click",placement:"bottom-start",size:"148"},on:{command:e.change_state_src}},[s("el-button",{staticClass:"change_src_btn"},[s("span",[e._v(e._s(e.network_detail.src_ip))]),e._v(" "),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{staticClass:"dropdown_ul_box_detail",staticStyle:{},attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{staticClass:"select_item",attrs:{command:"1"}},[e._v("威胁追查")]),e._v(" "),s("el-dropdown-item",{staticClass:"select_item",attrs:{command:"2"}},[e._v("添加到外部动态列表")])],1)],1)],1),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("目的地址:")]),e._v(" "),s("el-dropdown",{staticClass:"src_dropdown_box",attrs:{trigger:"click",placement:"bottom-start",size:"148"},on:{command:e.change_state_dest}},[s("el-button",{staticClass:"change_src_btn"},[s("span",[e._v(e._s(e.network_detail.dest_ip))]),e._v(" "),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{staticClass:"dropdown_ul_box_detail",staticStyle:{},attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{staticClass:"select_item",attrs:{command:"1"}},[e._v("威胁追查")]),e._v(" "),s("el-dropdown-item",{staticClass:"select_item",attrs:{command:"2"}},[e._v("添加到外部动态列表")])],1)],1)],1),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("源标签:")]),e._v(" "),s("div",{staticClass:"item_li_content"},[0!=e.network_detail.src_label_obj.length?s("ul",e._l(e.network_detail.src_label_obj,function(t){return s("li",{staticClass:"tag_btn_box"},[s("span",{staticClass:"tag_btn"},[e._v(e._s(t))])])}),0):e._e()])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("目的标签:")]),e._v(" "),s("div",{staticClass:"item_li_content"},[0!=e.network_detail.dest_label_obj.length?s("ul",e._l(e.network_detail.dest_label_obj,function(t){return s("li",{staticClass:"tag_btn_box"},[s("span",{staticClass:"tag_btn"},[e._v(e._s(t))])])}),0):e._e()])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("告警时间:")]),e._v(" "),s("span",{staticClass:"item_li_content"},[e._v(e._s(e.network_detail.alert_time))])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("威胁指标:")]),e._v(" "),s("span",{staticClass:"item_li_content"},[e._v(e._s(e.network_detail.indicator))])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("告警类型:")]),e._v(" "),s("span",{staticClass:"item_li_content"},[e._v(e._s(e.network_detail.category))])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("状态:")]),e._v(" "),s("span",{staticClass:"item_li_content"},[e._v(e._s(e._f("alert_status")(e.network_detail.status)))])])])]),e._v(" "),s("div",{staticClass:"detail_base_bottom_item"},[s("ul",[s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("应用:")]),e._v(" "),s("span",{staticClass:"item_li_content"},[e._v(e._s(e.network_detail.application))])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("检测引擎:")]),e._v(" "),s("span",{staticClass:"item_li_content"},[e._v(e._s(e.network_detail.detect_engine))])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("失陷确定性:")]),e._v(" "),s("span",{class:"0"==e.network_detail.fall_certainty?"":"fall_certainty"},[e._v("\n              "+e._s("0"==e.network_detail.fall_certainty?"":"已失陷"))])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("标签:")]),e._v(" "),s("div",{staticClass:"item_li_content"},[0!=e.network_detail.label_obj.length?s("ul",e._l(e.network_detail.label_obj,function(t){return s("li",{staticClass:"tag_btn_box"},[s("span",{staticClass:"tag_btn"},[e._v(e._s(t))])])}),0):e._e()])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("攻击阶段:")]),e._v(" "),s("span",{staticClass:"item_li_content"},[e._v(e._s(e.network_detail.attack_stage_cn))])]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("工单名称:")]),e._v(" "),""!=e.network_work_order.work_name?s("span",{staticClass:"item_li_content Goto_workorder",on:{click:e.Goto_workorder}},[e._v(e._s(e.network_work_order.work_name))]):e._e()]),e._v(" "),s("li",{staticClass:"item_li"},[s("span",{staticClass:"item_li_title"},[e._v("工单状态:")]),e._v(" "),s("span",{staticClass:"item_li_content"},[e._v(e._s(e.network_work_order.work_order_status))])])])])])]),e._v(" "),s("div",{staticClass:"detail_time_box"},[s("p",{staticClass:"time_title"},[e._v("检测时间轴")]),e._v(" "),s("div",{staticClass:"time_content"},[s("div",{staticClass:"time_left"},[s("ul",{staticClass:"time_left_list"},e._l(e.network_times,function(t,i){return s("li",{staticClass:"time_item",class:{active:e.time_choose==i},on:{click:function(t){return e.time_active(i)}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.time_choose==i,expression:"time_choose==index"}],staticClass:"triangle"}),e._v(" "),s("div",{staticClass:"time_item_left"},[s("img",{directives:[{name:"show",rawName:"v-show",value:e.time_choose!=i,expression:"time_choose!=index"}],attrs:{src:a("5/0U")}}),e._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:e.time_choose==i,expression:"time_choose==index"}],attrs:{src:a("mURi")}})]),e._v(" "),s("div",{staticClass:"time_item_right"},[s("p",[e._v(e._s(t.alert_time)+" ")])])])}),0)]),e._v(" "),s("div",{staticClass:"time_right"},e._l(e.network_times,function(t,a){return s("div",{directives:[{name:"show",rawName:"v-show",value:e.time_choose==a,expression:"time_choose==index"}]},[s("p",{staticClass:"title"},[e._v("详细信息")]),e._v(" "),s("div",{staticClass:"time_right_info"},[s("div",{staticClass:"time_right_info_top"},e._l(t.info_list,function(a){return s("li",{staticClass:"info_top_item"},[s("span",{staticClass:"info_top_item_title"},[e._v(e._s(a.name))]),e._v(" "),"文件大小"==a.name?s("span",[e._v("\n                  "+e._s(e._f("filterType")(a.value))+"\n                ")]):e._e(),e._v(" "),"文件大小"!=a.name?s("span",{staticClass:"info_top_item_content",class:"点击下载"==a.value?"download_text":"",on:{click:function(s){return e.download(a,t)}}},[e._v(e._s(a.value))]):e._e()])}),0),e._v(" "),0!=t.whois_list.length?s("div",{staticClass:"time_right_info_bom"},[s("span",{staticClass:"info_bom_title"},[e._v("Whois信息")]),e._v(" "),s("div",{staticClass:"info_bom_item"},e._l(t.whois_list,function(t){return s("div",{staticClass:"info_bom_item_li"},[s("div",{staticClass:"left_li"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"right_li"},[e._v(e._s(t.value))])])}),0)]):e._e()]),e._v(" "),s("p",{staticClass:"title"},[e._v("网络事件")]),e._v(" "),s("div",{staticClass:"time_right_net"},e._l(t.event_list,function(t){return s("div",{staticClass:"time_right_net_item"},[s("div",{staticClass:"title_net"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"value_net"},[e._v(e._s(t.value))])])}),0)])}),0)])]),e._v(" "),s("div",{staticClass:"attack_stage_box"},[e._m(1),e._v(" "),s("div",{staticClass:"attack_stage_bom"},[s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[0].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[0].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[0].count>0?"count_color":""},[e._v("初始访问")])]),e._v(" "),e._m(2),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[1].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[1].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[1].count>0?"count_color":""},[e._v("执行")])]),e._v(" "),e._m(3),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[2].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[2].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[2].count>0?"count_color":""},[e._v("持久化")])]),e._v(" "),e._m(4),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[3].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[3].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[3].count>0?"count_color":""},[e._v("提权")])]),e._v(" "),e._m(5),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[4].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[4].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[4].count>0?"count_color":""},[e._v("防御逃逸")])]),e._v(" "),e._m(6),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[5].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[5].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[5].count>0?"count_color":""},[e._v("凭证访问")])]),e._v(" "),e._m(7),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[6].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[6].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[6].count>0?"count_color":""},[e._v("信息发现")])]),e._v(" "),e._m(8),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[7].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[7].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[7].count>0?"count_color":""},[e._v("横向移动")])]),e._v(" "),e._m(9),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[8].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[8].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[8].count>0?"count_color":""},[e._v("信息收集")])]),e._v(" "),e._m(10),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[9].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[9].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[9].count>0?"count_color":""},[e._v("命令控制")])]),e._v(" "),e._m(11),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[10].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[10].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[10].count>0?"count_color":""},[e._v("信息泄露")])]),e._v(" "),e._m(12),e._v(" "),s("div",{staticClass:"stage_item_box"},[e.attack_stage_list[11].count>1?s("span",{staticClass:"circle_box"},[e._v("\n          "+e._s(e.attack_stage_list[11].count)+"\n        ")]):e._e(),e._v(" "),s("span",{class:e.attack_stage_list[11].count>0?"count_color":""},[e._v("毁坏")])])])]),e._v(" "),s("div",{staticClass:"suggest_box"},[e._m(13),e._v(" "),s("div",{staticClass:"suggest_bom"},[s("p",{staticClass:"suggest_bom_title"},[e._v("威胁描述")]),e._v(" "),s("p",{staticClass:"suggest_bom_des"},[e._v(e._s(e.suggest_list[e.network_detail.safety_suggestion].des))]),e._v(" "),s("p",{staticClass:"suggest_bom_title"},[e._v("安全建议")]),e._v(" "),e._m(14),e._v(" "),s("div",e._l(e.suggest_list[e.network_detail.safety_suggestion].handle,function(t){return s("p",{staticClass:"suggest_bom_li"},[e._v("\n          "+e._s(t)+"\n        ")])}),0),e._v(" "),e._m(15),e._v(" "),s("div",e._l(e.suggest_list[e.network_detail.safety_suggestion].reinforce,function(t){return s("p",{staticClass:"suggest_bom_li"},[e._v("\n          "+e._s(t)+"\n        ")])}),0)])]),e._v(" "),s("div",{staticClass:"emerge_box"},[s("el-tabs",{staticClass:"reset_tab",on:{"tab-click":e.handleClick},model:{value:e.emerge_list.activeName,callback:function(t){e.$set(e.emerge_list,"activeName",t)},expression:"emerge_list.activeName"}},[s("el-tab-pane",{staticClass:"tabs-item",attrs:{label:"当前受威胁资产",name:"first"}},[s("el-table",{ref:"multipleTable",staticClass:"emerge_table",staticStyle:{width:"100%"},attrs:{align:"center",data:e.emerge_list.now.data,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{prop:"alert_time",label:"时间","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"category",label:"告警类型","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"indicator",label:"威胁指标","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"src_ip",label:"源地址","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"dest_ip",label:"目的地址","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"application",label:"应用","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:"威胁等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticClass:"btn_alert_background",class:{high_background:"高"==t.row.degree,mid_background:"中"==t.row.degree,low_background:"低"==t.row.degree}},[e._v("\n                "+e._s(e._f("degree_sino")(t.row.degree)))])]}}])})],1),e._v(" "),s("el-pagination",{staticClass:"pagination_box",attrs:{"current-page":e.emerge_list.now.pageNow,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next",total:e.emerge_list.now.count},on:{"size-change":e.handleSizeChange_now,"current-change":e.handleCurrentChange_now}})],1),e._v(" "),s("el-tab-pane",{staticClass:"tabs-item",attrs:{label:"历史受威胁资产",name:"second"}},[s("el-table",{ref:"multipleTable",staticClass:"emerge_table",staticStyle:{width:"100%"},attrs:{align:"center",data:e.emerge_list.old.data,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{prop:"alert_time",label:"时间","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"category",label:"告警类型","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"indicator",label:"威胁指标","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"src_ip",label:"源地址","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"dest_ip",label:"目的地址","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"application",label:"应用","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:"威胁等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticClass:"btn_alert_background",class:{high_background:"高"==t.row.degree,mid_background:"中"==t.row.degree,low_background:"低"==t.row.degree}},[e._v("\n                "+e._s(e._f("degree_sino")(t.row.degree)))])]}}])})],1),e._v(" "),s("el-pagination",{staticClass:"pagination_box",attrs:{"current-page":e.emerge_list.old.pageNow,"page-sizes":[10,20,50,100],"page-size":10,layout:"total, sizes, prev, pager, next",total:e.emerge_list.old.count},on:{"size-change":e.handleSizeChange_old,"current-change":e.handleCurrentChange_old}})],1)],1)],1),e._v(" "),s("el-dialog",{staticClass:"add_tag pop_box",attrs:{"close-on-click-modal":!1,"modal-append-to-body":!1,visible:e.edit_tag.pop},on:{"update:visible":function(t){return e.$set(e.edit_tag,"pop",t)}}},[s("img",{staticClass:"closed_img",attrs:{src:a("6an9"),alt:""},on:{click:e.closed_edit_tag_box}}),e._v(" "),s("div",{staticClass:"title"},[s("div",{staticClass:"mask"}),e._v(" "),s("span",{staticClass:"title_name"},[e._v("编辑标签")])]),e._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"content_item"},e._l(e.edit_tag.tag_list,function(t,i){return s("div",{staticClass:"item_addrs"},[s("el-input",{staticClass:"select_box",attrs:{placeholder:"请输入标签，最多可以设置5个标签",clearable:""},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}}),e._v(" "),t.icon?s("img",{staticClass:"img_box",attrs:{src:a("uJWp"),alt:""},on:{click:e.add_tag}}):e._e(),e._v(" "),t.icon?e._e():s("img",{staticClass:"img_box",attrs:{src:a("ic23"),alt:""},on:{click:function(a){return e.del_tag(t,i)}}})],1)}),0)]),e._v(" "),s("div",{staticClass:"btn_box"},[s("el-button",{staticClass:"cancel_btn",on:{click:e.closed_edit_tag_box}},[e._v("取消")]),e._v(" "),s("el-button",{staticClass:"ok_btn",on:{click:e.edit_tag_true}},[e._v("确定")])],1)]),e._v(" "),s("el-dialog",{staticClass:"pop_state_add pop_box",attrs:{"close-on-click-modal":!1,"modal-append-to-body":!1,visible:e.add_state_change},on:{"update:visible":function(t){e.add_state_change=t}}},[s("img",{staticClass:"closed_img",attrs:{src:a("6an9"),alt:""},on:{click:e.add_closed_state1}}),e._v(" "),s("div",{staticClass:"title"},[s("div",{staticClass:"mask"}),e._v(" "),s("span",{staticClass:"title_name"},[e._v("添加到工单")])]),e._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"add_works"},[s("el-table",{ref:"multipleTable",staticClass:"reset_table",staticStyle:{width:"100%"},attrs:{align:"center",data:e.table_add_works.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handle_sel_table_add_works}},[s("el-table-column",{attrs:{label:"选择",width:"50"}}),e._v(" "),s("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"工单名称","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"creator",label:"创建人","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:"优先级",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("priority")(t.row.priority)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"new_perator",label:"经办人","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:"状态",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("work_status")(t.row.status)))]}}])})],1),e._v(" "),s("el-pagination",{staticClass:"pagination_box",attrs:{"current-page":e.table_add_works.pageNow,"page-sizes":[10,20,50,100],"page-size":e.table_add_works.eachPage,layout:"total, sizes, prev, pager, next",total:e.table_add_works.count},on:{"size-change":e.sc_table_add_works,"current-change":e.hcc_table_add_works}})],1)]),e._v(" "),s("div",{staticClass:"btn_box"},[s("el-button",{staticClass:"cancel_btn",on:{click:e.add_closed_state1}},[e._v("取消")]),e._v(" "),s("el-button",{staticClass:"ok_btn",on:{click:e.add_ok_state}},[e._v("确定")])],1)]),e._v(" "),s("el-dialog",{staticClass:"task_new_box pop_box",attrs:{"close-on-click-modal":!1,"modal-append-to-body":!1,visible:e.new_worksheets_data.pop},on:{"update:visible":function(t){return e.$set(e.new_worksheets_data,"pop",t)}}},[s("img",{staticClass:"closed_img",attrs:{src:a("6an9"),alt:""},on:{click:e.closed_task_new}}),e._v(" "),s("div",{staticClass:"title"},[s("div",{staticClass:"mask"}),e._v(" "),s("span",{staticClass:"title_name"},[e._v("编辑工单")])]),e._v(" "),s("div",{staticClass:"step_box"},[s("div",{staticClass:"step_box1"},[s("span",{staticClass:"step1_span",class:e.new_worksheets_data.new_contet?"step_now":"step_past"},[e._v("基本信息")]),e._v(" "),s("img",{staticClass:"selected_img",attrs:{src:a("4CQt"),alt:""}})]),e._v(" "),s("div",{staticClass:"step_box2"},[s("span",{staticClass:"step2_span",class:e.new_worksheets_data.new_contet?"step_past":"step_now"},[e._v("处置内容")])])]),e._v(" "),e.new_worksheets_data.new_contet?s("div",{staticClass:"task_new_content"},[s("div",{staticClass:"task_content_box"},[s("div",{staticClass:"content_top"},[s("div",{staticClass:"content_top_left"},[s("li",{staticClass:"left_item"},[s("div",{staticClass:"title"},[s("span",[e._v("工单名称")]),e._v(" "),s("span",{staticClass:"improtant_ico"},[e._v("*")])]),e._v(" "),s("el-input",{staticClass:"task_new_input",attrs:{placeholder:"请输入工单名称","show-word-limit":"",maxlength:"32",clearable:""},model:{value:e.new_worksheets_list.name,callback:function(t){e.$set(e.new_worksheets_list,"name",t)},expression:"new_worksheets_list.name"}})],1),e._v(" "),s("li",{staticClass:"left_item"},[s("div",{staticClass:"title"},[s("span",[e._v("经办人")]),e._v(" "),s("span",{staticClass:"improtant_ico"},[e._v("*")])]),e._v(" "),s("el-select",{staticClass:"task_new_input",attrs:{clearable:"",placeholder:"请选择经办人"},model:{value:e.new_worksheets_list.operator,callback:function(t){e.$set(e.new_worksheets_list,"operator",t)},expression:"new_worksheets_list.operator"}},e._l(e.new_worksheets_data.operator_list,function(t){return s("el-option",{key:t.id,attrs:{label:t.username,value:t.username},nativeOn:{click:function(a){return e.select_changced(t)}}})}),1)],1)]),e._v(" "),s("div",{staticClass:"content_top_right"},[s("li",{staticClass:"right_item"},[s("div",{staticClass:"title"},[s("span",[e._v("优先级")]),e._v(" "),s("span",{staticClass:"improtant_ico"},[e._v("*")])]),e._v(" "),s("el-select",{staticClass:"task_new_input",attrs:{clearable:"",placeholder:"请选择优先级"},model:{value:e.new_worksheets_list.level,callback:function(t){e.$set(e.new_worksheets_list,"level",t)},expression:"new_worksheets_list.level"}},e._l(e.new_worksheets_data.level_list,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("li",{staticClass:"right_item"},[s("el-checkbox-group",{model:{value:e.new_worksheets_list.notice,callback:function(t){e.$set(e.new_worksheets_list,"notice",t)},expression:"new_worksheets_list.notice"}},[s("el-checkbox",{attrs:{label:"email",value:"email"}},[e._v("邮件通知")]),e._v(" "),s("el-checkbox",{attrs:{label:"message",value:"message"}},[e._v("短信通知")])],1)],1)])]),e._v(" "),s("div",{staticClass:"content_remarks"},[s("p",{staticClass:"title"},[e._v("备注")]),e._v(" "),s("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容",maxlength:"500","show-word-limit":""},model:{value:e.new_worksheets_list.textarea,callback:function(t){e.$set(e.new_worksheets_list,"textarea",t)},expression:"new_worksheets_list.textarea"}})],1),e._v(" "),s("div",{staticClass:"content_table"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.new_worksheets_data.table_operator.tableData}},[s("el-table-column",{attrs:{prop:"username",label:"经办人"}}),e._v(" "),s("el-table-column",{attrs:{prop:"department",label:"部门"}}),e._v(" "),s("el-table-column",{attrs:{prop:"email_addr",label:"邮箱"}})],1)],1)]),e._v(" "),s("div",{staticClass:"btn_box"},[s("el-button",{staticClass:"cancel_btn",on:{click:e.closed_task_new}},[e._v("取消")]),e._v(" "),s("el-button",{staticClass:"next_btn",on:{click:e.next_task}},[e._v("下一步")])],1)]):e._e(),e._v(" "),e.new_worksheets_data.new_contet?e._e():s("div",{staticClass:"task_handle_content"},[s("div",{staticClass:"task_content_box"},[s("div",{staticClass:"table_box"},[s("div",[s("div",[s("el-table",{staticStyle:{width:"100%"},attrs:{align:"center",data:e.new_worksheets_data.network_detail,"tooltip-effect":"dark"},on:{"selection-change":e.select_alert_new}},[s("el-table-column",{attrs:{prop:"category",label:"告警类型","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"indicator",label:"威胁指标","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"src_ip",label:"源地址","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"dest_ip",label:"目的地址","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{prop:"application",label:"应用","show-overflow-tooltip":""}}),e._v(" "),s("el-table-column",{attrs:{label:"威胁等级",width:"100","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticClass:"btn_alert_background",class:{high_background:"high"==t.row.degree,mid_background:"medium"==t.row.degree,low_background:"low"==t.row.degree}},[e._v("\n                      "+e._s(e._f("degree")(t.row.degree)))])]}}],null,!1,2898832068)}),e._v(" "),s("el-table-column",{attrs:{label:"失陷确定性",width:"100","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{class:{fall_certainty:"1"==t.row.fall_certainty}},[e._v("\n                      "+e._s(e._f("certainty")(t.row.fall_certainty)))])]}}],null,!1,503520717)}),e._v(" "),s("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("work_status")(t.row.status)))]}}],null,!1,1762029338)})],1)],1)])])]),e._v(" "),s("div",{staticClass:"btn_box"},[s("el-button",{staticClass:"cancel_btn",on:{click:e.closed_task_new}},[e._v("取消")]),e._v(" "),s("el-button",{staticClass:"prev_btn",on:{click:e.prev_task_handle}},[e._v("上一步")]),e._v(" "),s("el-button",{staticClass:"prev_btn",on:{click:e.prev_task_handle_assign}},[e._v("分配")]),e._v(" "),s("el-button",{staticClass:"prev_btn",on:{click:e.prev_task_handle_save}},[e._v("保存")])],1)])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"top_left"},[t("img",{attrs:{src:a("LR8m"),alt:""}}),this._v(" "),t("img",{attrs:{src:a("zqFB"),alt:""}}),this._v(" "),t("img",{attrs:{src:a("4bp+"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"detail_base_top"},[t("img",{staticClass:"icon_img",attrs:{src:a("Rep4"),alt:""}}),this._v(" "),t("span",{staticClass:"attack_stage_title"},[this._v("攻击阶段分布")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"stage_img_box"},[t("img",{attrs:{src:a("tBkO"),alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"suggest_top"},[t("img",{staticClass:"icon_img",attrs:{src:a("jH10"),alt:""}}),this._v(" "),t("span",{staticClass:"suggest_title"},[this._v("威胁及安全建议")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"suggest_bom_list"},[t("img",{staticClass:"suggest_icon",attrs:{src:a("LALK"),alt:""}}),this._v(" "),t("span",{staticClass:"suggest_bom_title"},[this._v("处置建议")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"suggest_bom_list"},[t("img",{staticClass:"suggest_icon",attrs:{src:a("LALK"),alt:""}}),this._v(" "),t("span",{staticClass:"suggest_bom_title"},[this._v("加固建议")])])}]};var d=a("VU/8")(_,c,!1,function(e){a("wjWe"),a("HF0D"),a("lMEi")},"data-v-2502e5a6",null);t.default=d.exports},wjWe:function(e,t){},zqFB:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAMCAYAAAB4MH11AAAAAXNSR0IArs4c6QAAAItJREFUOBFjYKAyePv27YL///9zwYxlBAo0wDjUoIGG1zMyMl4DmhUqLCx8jfHNmzf/qWEwFjO+AcWymbBIUFPoPwvQO41UNREtiKhpNtgs9EiGWwCKeZAkXIBKDEaQOUCDtYDUaqAlWtQOMlAqSgAaPhWI4WkXyKYaAKUiWiVTsCNpHkTwoKBVJAMAnrtCdkNJGIgAAAAASUVORK5CYII="}});