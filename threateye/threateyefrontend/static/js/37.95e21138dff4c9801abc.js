webpackJsonp([37],{oDyU:function(e,t){},ve8e:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"report-sending",data:function(){return{send_config:{cycle:"daily",receiver:[],receiver_list:[],report_type:"",status:"",receiver_edit:[]}}},mounted:function(){this.get_data()},methods:{get_data:function(){var e=this;this.$axios.get("/yiiapi/report/get-config").then(function(t){var s=t.data,i=(s.status,s.data);e.send_config.status=i.status+"",e.send_config.cycle=i.cycle,e.send_config.receiver=i.receiver,e.send_config.report_type=i.report_type,e.send_config.receiver_list=[],console.log(e.send_config),0==e.send_config.receiver.length?e.send_config.receiver_list.push({name:"",icon:!0}):(e.send_config.receiver.forEach(function(t){e.send_config.receiver_list.push({name:t,icon:!1})}),e.send_config.receiver_list[e.send_config.receiver_list.length-1].icon=!0)}).catch(function(e){console.log(e)})},edit_data:function(){var e=this;if(this.send_config.receiver_edit=[],0==this.send_config.receiver_list.length)return this.$message({message:"请输入发件人邮箱",type:"warning"}),!1;this.send_config.receiver_list.forEach(function(t){""!=t.name&&e.send_config.receiver_edit.push(t.name)}),this.$axios.post("/yiiapi/report/set-config",{status:this.send_config.status,cycle:this.send_config.cycle,report_type:this.send_config.report_type,receiver:this.send_config.receiver_edit}).then(function(t){var s=t.data,i=s.status,n=s.data;console.log(n),console.log(i),"success"==i&&(e.get_data(),e.$message({message:"修改成功",type:"success"}))}).catch(function(e){console.log(e)})},add_email:function(){this.send_config.receiver_list.length<5?(this.send_config.receiver_list.forEach(function(e){e.icon=!1}),this.send_config.receiver_list.push({ip:"",icon:!0})):this.$message.warning({message:"最多可以设置5个收件人邮箱。",offset:50})},del_email:function(e,t){console.log(this.send_config.receiver_list),this.send_config.receiver_list.splice(t,1)}}},n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"report-sending"}},[i("div",{staticClass:"r_top"},[e._m(0),e._v(" "),i("el-form",{staticClass:"r_content_main"},[i("el-row",{staticClass:"r_main_list",attrs:{type:"flex"}},[i("el-col",{attrs:{span:3}},[i("span",{staticClass:"title"},[e._v("状态")])]),e._v(" "),i("el-col",{attrs:{span:21}},[i("div",{staticClass:"r_radio"},[i("el-radio",{staticClass:"r_radio_item",attrs:{label:"1"},model:{value:e.send_config.status,callback:function(t){e.$set(e.send_config,"status",t)},expression:"send_config.status"}},[e._v("启用")]),e._v(" "),i("el-radio",{staticClass:"r_radio_item",attrs:{label:"0"},model:{value:e.send_config.status,callback:function(t){e.$set(e.send_config,"status",t)},expression:"send_config.status"}},[e._v("停用")])],1)])],1),e._v(" "),i("el-row",{staticClass:"r_main_list",attrs:{type:"flex"}},[i("el-col",{attrs:{span:3}},[i("span",{staticClass:"title"},[e._v("发送周期")])]),e._v(" "),i("el-col",{attrs:{span:21}},[i("div",{staticClass:"r_radio"},[i("el-radio",{staticClass:"r_radio_item",attrs:{label:"daily"},model:{value:e.send_config.cycle,callback:function(t){e.$set(e.send_config,"cycle",t)},expression:"send_config.cycle"}},[e._v("每日")]),e._v(" "),i("el-radio",{staticClass:"r_radio_item",attrs:{label:"weekly"},model:{value:e.send_config.cycle,callback:function(t){e.$set(e.send_config,"cycle",t)},expression:"send_config.cycle"}},[e._v("每周")]),e._v(" "),i("el-radio",{staticClass:"r_radio_item",attrs:{label:"monthly"},model:{value:e.send_config.cycle,callback:function(t){e.$set(e.send_config,"cycle",t)},expression:"send_config.cycle"}},[e._v("每月")])],1)])],1),e._v(" "),i("el-row",{staticClass:"r_main_list",attrs:{type:"flex"}},[i("el-col",{attrs:{span:3}},[i("span",{staticClass:"title"},[e._v("发送格式")])]),e._v(" "),i("el-col",{attrs:{span:21}},[i("div",{staticClass:"r_radio"},[i("el-radio",{staticClass:"r_radio_item",attrs:{label:"doc"},model:{value:e.send_config.report_type,callback:function(t){e.$set(e.send_config,"report_type",t)},expression:"send_config.report_type"}},[e._v("Word")]),e._v(" "),i("el-radio",{staticClass:"r_radio_item",attrs:{label:"excel"},model:{value:e.send_config.report_type,callback:function(t){e.$set(e.send_config,"report_type",t)},expression:"send_config.report_type"}},[e._v("Excel")])],1)])],1),e._v(" "),i("el-row",{staticClass:"r_main_list r_special_list",attrs:{type:"flex"}},[i("el-col",{attrs:{span:3}},[i("span",{staticClass:"title"},[e._v("收件人邮箱")])]),e._v(" "),i("el-col",{attrs:{span:21}},e._l(e.send_config.receiver_list,function(t,n){return i("div",{staticClass:"item_addrs"},[i("el-input",{staticClass:"select_box",attrs:{placeholder:"请输收件人邮箱,最多可以设置5个收件人邮箱。",clearable:""},model:{value:t.name,callback:function(s){e.$set(t,"name",s)},expression:"item.name"}}),e._v(" "),t.icon?i("img",{staticClass:"img_box",attrs:{src:s("uJWp"),alt:""},on:{click:e.add_email}}):e._e(),e._v(" "),t.icon?e._e():i("img",{staticClass:"img_box",attrs:{src:s("ic23"),alt:""},on:{click:function(s){return e.del_email(t,n)}}})],1)}),0)],1),e._v(" "),i("div",{staticClass:"r_btn_group"},[i("el-button",{staticClass:"b_btn b_ok",on:{click:e.edit_data}},[e._v("确定")]),e._v(" "),i("el-button",{staticClass:"b_btn b_cancel",on:{click:e.get_data}},[e._v("取消")])],1)],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"r_content_top"},[t("h3",{staticClass:"title"},[this._v("报表发送")])])}]};var a=s("VU/8")(i,n,!1,function(e){s("oDyU")},"data-v-3052a8f8",null);t.default=a.exports}});